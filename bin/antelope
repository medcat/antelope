#!/usr/bin/env ruby

$: << File.expand_path("../../lib", __FILE__) << Dir.pwd
require "antelope"

ARGV.each do |program|
  grammar = Antelope::Ace::Grammar.from_file(program)

  out = grammar.generate

  pass = Hash[[:recognizer,
          :constructor,
          :conflictor,
          :table].zip(out)]

  file_name = File.basename(program, ".ace")

  File.open("#{file_name}.output", "w") do |f|
    f.write Antelope::Output.output(grammar, pass)
  end
end
